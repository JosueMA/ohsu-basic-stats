<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Alison Hill" />


<title>CONJ620: CM 2.1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CONJ 620</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="cm.html">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Class Meetings
  </a>
</li>
<li>
  <a href="due.html">
    <span class="fa fa-calendar-check"></span>
     
    Due Dates
  </a>
</li>
<li>
  <a href="https://www.datacamp.com/enterprise/conj-620-introduction-to-biostatistics-for-the-basic-sciences-data-wrangling-analysis-communication">
    <span class="fa fa-user-ninja"></span>
     
    DataCamp
  </a>
</li>
<li>
  <a href="https://sakai.ohsu.edu/portal/site/CONJ-620-1-2040-Su18">
    <span class="fa fa-university"></span>
     
    Sakai
  </a>
</li>
<li>
  <a href="https://gitter.im/conj620/Lobby?utm_source=share-link&amp;utm_medium=link&amp;utm_campaign=share-link">
    <span class="fa fa-comments"></span>
     
    Gitter Chat
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-cogs"></span>
     
    About
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">CONJ620: CM 2.1</h1>
<h3 class="subtitle"><em>Simple linear regression</em></h3>
<h4 class="author"><em>Alison Hill</em></h4>
<h4 class="date"><em>7/17/2018</em></h4>

</div>


<div id="overview" class="section level1">
<h1><span class="header-section-number">1</span> Overview</h1>
<ul>
<li>A complete knitted <code>html</code> file is due on Sakai by end of class Tuesday July 17th (before 5pm).</li>
<li>This lab is estimated to take approximately 40 minutes. We’ll work together in chunks to keep tabs on time, with the aim that we all <em>finish</em> during the in-class work period.</li>
<li>This lab is based on <a href="http://moderndive.netlify.com/6-regression.html">Chapter 6: Basic Regression in ModernDive</a>. Please open it and follow closely!</li>
<li>You’ll need to load these packages to do the lab:</li>
</ul>
<pre class="r"><code>library(moderndive)
library(tidyverse)
library(skimr)</code></pre>
</div>
<div id="the-data" class="section level1">
<h1><span class="header-section-number">2</span> The data</h1>
<p>Source: John Clay (1856). “On the Relation Between Crime, Popular Instruction, Attendance on Religious Worship, and Beer-Houses”, Journal of the Statistical Society of London, Vol. 20 #1, pp 22-32.</p>
<p>In 1856, the Reverend John Clay felt that it was high time to figure out what societal factors were playing a role in the incidence of criminal behavior in Britain. He stated that:</p>
<blockquote>
<p>“It is a mere truism to say that the progress of popular education, and the formation of religious habits, are fatally opposed by the temptations to animal pleasures, which abound wherever BEER-HOUSES and low ALE-HOUSES abound.”</p>
</blockquote>
<div class="figure">
<img src="http://4.bp.blogspot.com/-qdzqtghTzmU/UD_NNT9C46I/AAAAAAAABoQ/XycEe4wixVM/s1600/03.LesMiserables.US.MasteroftheHouse.jpg" />

</div>
<p><br> <br> <br></p>
<p>Clearly, the reverend considered public houses in Britain to be a scourge on society, namely that they “promote drunkenness and its consequent evil” (i.e., crime). Let’s investigate how well we can predict criminals (per 100k population) from the number of public houses (ale/beer houses per 100k population) using simple linear regression. Here is how to read in the data (please copy and paste into a code chunk in your .Rmd):</p>
<pre class="r"><code>crimenames &lt;- c(&quot;county&quot;, &quot;region_name&quot;, &quot;region_code&quot;,
               &quot;criminals&quot;, &quot;public_houses&quot;, &quot;school_attendance&quot;,
               &quot;worship_attendance&quot;)

crime &lt;- read_table(&quot;http://users.stat.ufl.edu/~winner/data/beerhall.dat&quot;,
                    col_names = crimenames)</code></pre>
</div>
<div id="basics-10-min" class="section level1">
<h1><span class="header-section-number">3</span> Basics (⏰ 10 min)</h1>
<p>Note: you don’t need to use R to answer these questions, but please create a section header using markdown format (<code># Basics</code>) and type your answers there.</p>
<ul>
<li>What is the dependent variable?</li>
<li>What is the independent variable?</li>
<li>Copy and paste the provided equation that starts/ends with <code>$$</code> into your narrative (not an R code chunk), and replace <code>y</code> and <code>x</code> in this formula with meaningful variable names (you may wish to reference the <code>crimenames</code> object we made above): <code>$$\hat{y} = b_0 + b_1{x}$$</code> <span class="math display">\[\hat{y} = b_0 + b_1{x}\]</span></li>
<li>The “best-fitting” regression line is “best” in that it minimizes what?</li>
<li>Why is this method called “simple linear regression” (as opposed to the method in <a href="http://moderndive.netlify.com/7-multiple-regression.html">Chapter 7</a>?</li>
</ul>
</div>
<div id="eda" class="section level1">
<h1><span class="header-section-number">4</span> EDA</h1>
<p>Conduct a new exploratory data analysis, which involves three things:</p>
<ul>
<li>Looking at the raw values.</li>
<li>Computing summary statistics of the variables of interest.</li>
<li>Creating informative visualizations.</li>
</ul>
<div id="look-at-the-data-all-together" class="section level2">
<h2><span class="header-section-number">4.1</span> Look at the data (all together)</h2>
<p>Use <code>dplyr</code> to figure out how many counties are in this dataset, and which variable names map onto the independent and dependent variables you identified above.</p>
<pre class="r"><code>glimpse(crime)</code></pre>
<pre><code>Observations: 40
Variables: 7
$ county             &lt;chr&gt; &quot;Middlesex&quot;, &quot;Surrey&quot;, &quot;Kent&quot;, &quot;Sussex&quot;, &quot;H...
$ region_name        &lt;chr&gt; &quot;South Eastern&quot;, &quot;South Eastern&quot;, &quot;South Ea...
$ region_code        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2...
$ criminals          &lt;dbl&gt; 200, 160, 160, 147, 178, 205, 183, 156, 173...
$ public_houses      &lt;dbl&gt; 541, 504, 552, 295, 409, 568, 708, 624, 463...
$ school_attendance  &lt;dbl&gt; 560, 630, 790, 820, 990, 930, 1020, 1130, 9...
$ worship_attendance &lt;dbl&gt; 434, 482, 680, 678, 798, 698, 888, 970, 848...</code></pre>
</div>
<div id="look-at-summary-statistics-5-min" class="section level2">
<h2><span class="header-section-number">4.2</span> Look at summary statistics (⏰ 5 min)</h2>
<p>Use <code>select</code> to select only the independent and dependent variables you identified above, then pipe those variables to <code>skimr</code> to see summary statistics for each. Use <code>dplyr::summarize</code> to calculate the correlation coefficient.</p>
<pre class="r"><code>crime %&gt;% 
  select(criminals, public_houses) %&gt;% 
  skim()</code></pre>
<pre><code>Skim summary statistics
 n obs: 40 
 n variables: 2 

Variable type: numeric 
      variable missing complete  n   mean     sd p0 p25   p50    p75 p100
     criminals       0       40 40 152.9   41.42 66 127 157.5 174.25  241
 public_houses       0       40 40 374.85 164.97 87 209 407   490.75  708
     hist
 ▂▂▃▅▇▂▃▁
 ▃▆▂▂▇▅▃▂</code></pre>
<pre class="r"><code>crime %&gt;% 
  summarize(corr = cor(criminals, public_houses))</code></pre>
<pre><code># A tibble: 1 x 1
   corr
  &lt;dbl&gt;
1 0.463</code></pre>
</div>
<div id="visualize-the-data-5-min" class="section level2">
<h2><span class="header-section-number">4.3</span> Visualize the data (⏰ 5 min)</h2>
<p>Recreate the scatterplot below of ale/beer houses per 100K on the x-axis and criminals per 100K population on the y-axis. What can you say about the relationship between public houses and criminals based on this exploration?</p>
<p><img src="cm021-solutions_files/figure-html/unnamed-chunk-4-1.png" width="2100" /></p>
</div>
</div>
<div id="simple-linear-regression-10-min" class="section level1">
<h1><span class="header-section-number">5</span> Simple linear regression (⏰ 10 min)</h1>
<p><strong>Part 1:</strong> First “fit” the linear regression model to the data using the <code>lm()</code> function, then apply the <code>get_regression_table()</code> function from the <code>moderndive</code> R package to the model object. Use the output to fill in this formula with <code>y</code>, <code>x</code>, and the intercept and slope coefficients: (copy and paste into your narative: <code>$$\hat{y} = b_0 + b_1{x}$$</code>)</p>
<p><span class="math display">\[\hat{y} = b_0 + b_1{x}\]</span></p>
<p><strong>Part 2:</strong> Interpret the intercept coefficient and the slope coefficient (see <a href="http://moderndive.netlify.com/6-regression.html#model1table">here</a> for an example). How do the regression results match up with the results from your exploratory data analysis above?</p>
<pre class="r"><code>crime_lm &lt;- lm(criminals ~ public_houses, data = crime)
get_regression_table(crime_lm)</code></pre>
<pre><code># A tibble: 2 x 7
  term          estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept      109.       14.8        7.41   0       79.5    139.   
2 public_houses    0.116     0.036      3.22   0.003    0.043    0.189</code></pre>
</div>
<div id="observedfitted-values-and-residuals-10-min" class="section level1">
<h1><span class="header-section-number">6</span> Observed/fitted values and residuals (⏰ 10 min)</h1>
<p><strong>Part 1:</strong> What are the observed and fitted values for the Cornwall (<code>ID</code> = 20) and Monmouth regions (<code>ID</code> = 23)? Which region do you think the reverend called “the happiest example of the infrequency of crime”?</p>
<pre class="r"><code>regression_points &lt;- get_regression_points(crime_lm)
regression_points %&gt;% 
  filter(ID %in% c(20, 23))</code></pre>
<pre><code># A tibble: 2 x 5
     ID criminals public_houses criminals_hat residual
  &lt;int&gt;     &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1    20        66            87          119.    -53.4
2    23       241           350          150.     91.0</code></pre>
<p><strong>Part 2:</strong> In fact, we could argue with the reverend about the happiest example of the infrequency of crime. There are two ways you could define this, and you’ll do with with a <code>filter</code> using the <code>|</code> operator (think: <code>or</code>).</p>
<p>The first way is that the county had the lowest criminals overall. The second is that the county had the lowest criminals <em>given their number of public houses</em>. This would mean that the region has the lowest observed criminals, compared to the fitted value based on predicting criminals from public houses. You’ll need to match the <code>ID</code> column as a row in the original data (you can just do this visually by comparing the tibbles and typing your answers in your narrative- you don’t have to do a join here).</p>
<pre class="r"><code># Derby is lowest residual (ID = 20)
# Cornwall is the lowest observed (ID = 33)
regression_points %&gt;% 
  filter(criminals == min(criminals) | residual == min(residual))</code></pre>
<pre><code># A tibble: 2 x 5
     ID criminals public_houses criminals_hat residual
  &lt;int&gt;     &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1    20        66            87          119.    -53.4
2    33        83           449          162.    -78.5</code></pre>
<pre class="r"><code>regression_points %&gt;% 
  left_join(select(crime, county, criminals, public_houses)) %&gt;% 
  filter(criminals == min(criminals) | residual == min(residual))</code></pre>
<pre><code># A tibble: 2 x 6
     ID criminals public_houses criminals_hat residual county  
  &lt;int&gt;     &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   
1    20        66            87          119.    -53.4 Cornwall
2    33        83           449          162.    -78.5 Derby   </code></pre>
</div>
<div id="residual-analysis-10-min" class="section level1">
<h1><span class="header-section-number">7</span> Residual analysis (⏰ 10 min)</h1>
<p><strong>Part 1:</strong> Perform a residual analysis and look for any systematic patterns in the residuals. Ideally, there should be little to no pattern- why? Does it seem like there is no systematic pattern to the residuals?</p>
<pre class="r"><code>ggplot(regression_points, aes(x = public_houses, y = residual)) +
  geom_point() +
  labs(x = &quot;Public Houses&quot;, y = &quot;Residual&quot;) +
  geom_hline(yintercept = 0, col = &quot;blue&quot;, size = 1)</code></pre>
<p><img src="cm021-solutions_files/figure-html/unnamed-chunk-8-1.png" width="2100" /></p>
<p><strong>Part 2:</strong> Recreate this density plot of the residuals (hint: <code>?geom_vline()</code>). Recall that we would like the residuals to be normally distributed with mean 0. Use <code>dplyr</code> to calculate the mean of the residuals- is it (pretty close to) 0? Do you think you have more positive residuals than negative, or vice versa?</p>
<p><img src="cm021-solutions_files/figure-html/unnamed-chunk-9-1.png" width="2100" /></p>
<pre class="r"><code>regression_points %&gt;% 
  summarize(mean_resid = mean(residual))</code></pre>
<pre><code># A tibble: 1 x 1
  mean_resid
       &lt;dbl&gt;
1   0.000025</code></pre>
</div>

<p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="by-nc.png" height="400" width="65"/></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
