<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Alison Hill" />


<title>CONJ620: CM 3.2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CONJ 620</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="cm.html">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Class Meetings
  </a>
</li>
<li>
  <a href="due.html">
    <span class="fa fa-calendar-check"></span>
     
    Due Dates
  </a>
</li>
<li>
  <a href="https://www.datacamp.com/enterprise/conj-620-introduction-to-biostatistics-for-the-basic-sciences-data-wrangling-analysis-communication">
    <span class="fa fa-user-ninja"></span>
     
    DataCamp
  </a>
</li>
<li>
  <a href="https://sakai.ohsu.edu/portal/site/CONJ-620-1-2040-Su18">
    <span class="fa fa-university"></span>
     
    Sakai
  </a>
</li>
<li>
  <a href="https://gitter.im/conj620/Lobby?utm_source=share-link&amp;utm_medium=link&amp;utm_campaign=share-link">
    <span class="fa fa-comments"></span>
     
    Gitter Chat
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-cogs"></span>
     
    About
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">CONJ620: CM 3.2</h1>
<h3 class="subtitle"><em>Introduction to Inference</em></h3>
<h4 class="author"><em>Alison Hill</em></h4>

</div>


<div id="estimation-of-us-male-height" class="section level1">
<h1><span class="header-section-number">1</span> Estimation of US male height</h1>
<p>Suppose we want to estimate the average height of men in the U.S.</p>
<p>We can use data from the BRFSS:</p>
<p>“The Behavioral Risk Factor Surveillance System (BRFSS) is the nation’s premier system of health-related telephone surveys that collect state data about U.S. residents regarding their health-related risk behaviors, chronic health conditions, and use of preventive services.”</p>
<p>The following function reads the most recent data from BRFSS (2016), selects just the columns we need, and saves the results in an HDF file.</p>
<p>After we run this function, it is much faster to read the HDF file than the original data.</p>
<pre class="r"><code>male_heights &lt;- read_csv(here::here(&quot;data&quot;, &quot;male_heights.csv&quot;))</code></pre>
<div id="estimate" class="section level2">
<h2><span class="header-section-number">1.1</span> Estimate</h2>
<p>Height in self-reported height in centimeters.</p>
<p>How many unique heights are there?</p>
<pre class="r"><code>all_ones &lt;- male_heights %&gt;% 
  count(HTM4) %&gt;% 
  arrange(n)</code></pre>
<p>How many men were 103 cm? How about 231 cm?</p>
<p>What is the <code>mean</code> and <code>sd</code> of male heights?</p>
<pre class="r"><code>library(skimr)
skim(male_heights)</code></pre>
<pre><code>Skim summary statistics
 n obs: 204509 
 n variables: 4 

── Variable type:integer ────────────────────────────────────────────────────────────────────────────────────
 variable missing complete      n     mean       sd   p0   p25   p50
     HTM4       0   204509 204509   178.06     7.79   91   173   178
   id_num       0   204509 204509 1e+05    59036.81    1 51128 1e+05
    WTKG3    2970   201539 204509  8993.52  1930.56 2268  7711  8618
    p75  p100     hist
    183   231 ▁▁▁▁▇▇▁▁
 153382 2e+05 ▇▇▇▇▇▇▇▇
   9979 27216 ▁▇▇▁▁▁▁▁

── Variable type:numeric ────────────────────────────────────────────────────────────────────────────────────
 variable missing complete      n   mean      sd  p0    p25    p50    p75
  _LLCPWT       0   204509 204509 581.91 1013.13 0.8 102.05 252.75 631.23
     p100     hist
 28708.95 ▇▁▁▁▁▁▁▁</code></pre>
</div>
<div id="quantify-precision" class="section level2">
<h2><span class="header-section-number">1.2</span> Quantify precision</h2>
<p>At this point we have an estimate of the average adult male height. We’d like to know how accurate this estimate is, and how precise. In the context of estimation, these words have a technical distinction:</p>
<p>“Given a set of data points from repeated measurements of the same quantity, the set can be said to be precise if the values are close to each other, while the set can be said to be accurate if their average is close to the true value of the quantity being measured.”</p>
<p>Usually accuracy is what we really care about, but it’s hard to measure accuracy unless you know the true value. And if you knew the true value, you wouldn’t have to estimate it in the first place.</p>
<p>Quantifying precision is not as useful, but it is much easier. Here’s one way to do it:</p>
<ul>
<li><p>Use the data you have to make a model of the population.</p></li>
<li><p>Use the model to simulate the <strong>random</strong> data collection process.</p></li>
<li><p>Use the simulated data to compute an estimate.</p></li>
<li><p>Repeat steps 1-3 and collect the results.</p></li>
</ul>
<p>To model the population, I’ll use resampling; that is, I will treat the observed measurements as if they were taken from the entire population, and I will draw random samples from them.</p>
<p>Here’s a function that takes observed measurements and returns a new set of measurements with the same sample size.</p>
<p>We sample with replacement, which means that some measurements might be chosen more than once, and some might not be chosen at all. (If we sample without replacement, the resampled data is always identical to the original, so that’s no good.)</p>
<p>Let’s create our first resample, using the steps laid out in <a href="https://moderndive.com/9-confidence-intervals.html#bootstrapping">ModernDive</a>:</p>
<ul>
<li>Specify variables</li>
<li>Generate replicates</li>
<li>Calculate summary statistics</li>
<li>Visualize results</li>
</ul>
<pre class="r"><code>males &lt;- male_heights %&gt;% 
  tally() %&gt;% 
  pull()
set.seed(2051)
mh_resample1 &lt;- male_heights %&gt;% 
  sample_n(size = males, replace = TRUE)</code></pre>
<pre class="r"><code>mh_resample1 %&gt;% 
  count(HTM4 == 103)</code></pre>
<pre><code># A tibble: 1 x 2
  `HTM4 == 103`      n
  &lt;lgl&gt;          &lt;int&gt;
1 FALSE         204509</code></pre>
<pre class="r"><code>mh_resample1 %&gt;% 
  count(HTM4 == 231)</code></pre>
<pre><code># A tibble: 1 x 2
  `HTM4 == 231`      n
  &lt;lgl&gt;          &lt;int&gt;
1 FALSE         204509</code></pre>
<pre class="r"><code>set.seed(1903)
mh_resample2 &lt;- male_heights %&gt;% 
  sample_n(size = males, replace = TRUE)</code></pre>
<pre class="r"><code>mh_resample2 %&gt;% 
  count(HTM4 == 103)</code></pre>
<pre><code># A tibble: 2 x 2
  `HTM4 == 103`      n
  &lt;lgl&gt;          &lt;int&gt;
1 FALSE         204505
2 TRUE               4</code></pre>
<pre class="r"><code>mh_resample2 %&gt;% 
  count(HTM4 == 231)</code></pre>
<pre><code># A tibble: 2 x 2
  `HTM4 == 231`      n
  &lt;lgl&gt;          &lt;int&gt;
1 FALSE         204508
2 TRUE               1</code></pre>
<pre class="r"><code>set.seed(1701)
mh_resample3 &lt;- male_heights %&gt;% 
  sample_n(size = males, replace = TRUE)</code></pre>
<pre class="r"><code>mh_resample3 %&gt;% 
  count(HTM4 == 103)</code></pre>
<pre><code># A tibble: 2 x 2
  `HTM4 == 103`      n
  &lt;lgl&gt;          &lt;int&gt;
1 FALSE         204507
2 TRUE               2</code></pre>
<pre class="r"><code>mh_resample3 %&gt;% 
  count(HTM4 == 231)</code></pre>
<pre><code># A tibble: 2 x 2
  `HTM4 == 231`      n
  &lt;lgl&gt;          &lt;int&gt;
1 FALSE         204505
2 TRUE               4</code></pre>
<pre class="r"><code>skim(mh_resample1)</code></pre>
<pre><code>Skim summary statistics
 n obs: 204509 
 n variables: 4 

── Variable type:integer ────────────────────────────────────────────────────────────────────────────────────
 variable missing complete      n     mean       sd   p0   p25   p50
     HTM4       0   204509 204509   178.05     7.77   91   173   178
   id_num       0   204509 204509 1e+05    59027.77    1 51198 1e+05
    WTKG3    2920   201589 204509  8990.5   1924.91 2268  7711  8618
    p75  p100     hist
    183   229 ▁▁▁▁▆▇▁▁
 153458 2e+05 ▇▇▇▇▇▇▇▇
   9979 27216 ▁▇▇▁▁▁▁▁

── Variable type:numeric ────────────────────────────────────────────────────────────────────────────────────
 variable missing complete      n   mean      sd  p0    p25    p50    p75
  _LLCPWT       0   204509 204509 583.01 1012.17 0.8 101.98 253.18 632.08
     p100     hist
 27852.06 ▇▁▁▁▁▁▁▁</code></pre>
<pre class="r"><code>skim(mh_resample2)</code></pre>
<pre><code>Skim summary statistics
 n obs: 204509 
 n variables: 4 

── Variable type:integer ────────────────────────────────────────────────────────────────────────────────────
 variable missing complete      n     mean       sd   p0   p25   p50
     HTM4       0   204509 204509   178.03     7.8    91   173   178
   id_num       0   204509 204509 1e+05    59104.02    3 51074 1e+05
    WTKG3    3010   201499 204509  8988.75  1932.09 2268  7711  8618
    p75  p100     hist
    183   231 ▁▁▁▁▇▇▁▁
 153614 2e+05 ▇▇▇▇▇▇▇▇
   9979 27216 ▁▇▇▁▁▁▁▁

── Variable type:numeric ────────────────────────────────────────────────────────────────────────────────────
 variable missing complete      n   mean      sd  p0    p25   p50   p75
  _LLCPWT       0   204509 204509 584.05 1020.63 0.8 102.88 254.4 630.9
     p100     hist
 28708.95 ▇▁▁▁▁▁▁▁</code></pre>
<pre class="r"><code>skim(mh_resample3)</code></pre>
<pre><code>Skim summary statistics
 n obs: 204509 
 n variables: 4 

── Variable type:integer ────────────────────────────────────────────────────────────────────────────────────
 variable missing complete      n     mean       sd   p0   p25   p50
     HTM4       0   204509 204509   178.06     7.82   91   173   178
   id_num       0   204509 204509 1e+05    59122.79    3 51285 1e+05
    WTKG3    3037   201472 204509  8993.03  1936.52 2268  7711  8618
    p75  p100     hist
    183   231 ▁▁▁▁▇▇▁▁
 153699 2e+05 ▇▇▇▇▇▇▇▇
   9979 27216 ▁▇▇▁▁▁▁▁

── Variable type:numeric ────────────────────────────────────────────────────────────────────────────────────
 variable missing complete      n   mean      sd  p0    p25    p50   p75
  _LLCPWT       0   204509 204509 581.24 1016.46 0.8 102.16 252.82 630.8
     p100     hist
 28708.95 ▇▁▁▁▁▁▁▁</code></pre>
<p>If we wanted to use <code>infer</code> instead to generate a SINGLE replicate or resample, we would use:</p>
<pre class="r"><code>library(infer)
set.seed(1701)
mh_resample3 &lt;- male_heights %&gt;% 
  specify(response = HTM4) %&gt;% 
  generate(reps = 1, type = &quot;bootstrap&quot;)</code></pre>
<p>Now let’s <code>generate</code> 10,000 replicates, <code>calculate</code> the mean for each replicate, and make a histogram to show the distribution of all the 10,000 calculated means.</p>
<pre class="r"><code>set.seed(1701)
mh_boot &lt;- male_heights %&gt;% 
  specify(response = HTM4) %&gt;% 
  generate(reps = 1000, type = &quot;bootstrap&quot;) 

mh_boot %&gt;% 
  count(replicate)</code></pre>
<pre><code># A tibble: 1,000 x 2
# Groups:   replicate [1,000]
   replicate      n
       &lt;int&gt;  &lt;int&gt;
 1         1 204509
 2         2 204509
 3         3 204509
 4         4 204509
 5         5 204509
 6         6 204509
 7         7 204509
 8         8 204509
 9         9 204509
10        10 204509
# ... with 990 more rows</code></pre>
<pre class="r"><code>set.seed(1701)
mh_means &lt;- male_heights %&gt;% 
  specify(response = HTM4) %&gt;% 
  generate(reps = 1000, type = &quot;bootstrap&quot;) %&gt;% 
  calculate(stat = &quot;mean&quot;)

mh_means %&gt;% 
  visualize()</code></pre>
<p><img src="cm032_files/figure-html/unnamed-chunk-17-1.png" width="2100" /></p>
<pre class="r"><code>x_bar &lt;- male_heights %&gt;% 
  summarize(stat = mean(HTM4))
x_bar</code></pre>
<pre><code># A tibble: 1 x 1
   stat
  &lt;dbl&gt;
1  178.</code></pre>
<pre class="r"><code>mh_means %&gt;% 
  visualize(obs_stat = x_bar)</code></pre>
<p><img src="cm032_files/figure-html/unnamed-chunk-17-2.png" width="2100" /></p>
<p>The width of this distribution shows how much the results vary from one experiment to the next.</p>
<p>We can quantify this variability by computing the standard deviation of the sampling distribution, which is called “standard error”. The standard error is the standard deviation of the sampling distribution.</p>
<pre class="r"><code>options(pillar.sigfig = 6)

mh_means %&gt;% 
  summarize(mean_of_means = mean(stat),
            sd_of_means = sd(stat)) # this is the SE!</code></pre>
<pre><code># A tibble: 1 x 2
  mean_of_means sd_of_means
          &lt;dbl&gt;       &lt;dbl&gt;
1       178.062   0.0175575</code></pre>
<p>We can also summarize the sampling distribution with a “confidence interval”, which is a range that contains a specified fraction, like 90%, of the values in sampling_dist_mean.</p>
<p>The central 90% confidence interval is between the 5th and 95th percentiles of the sampling distribution.</p>
<pre class="r"><code>mh_means %&gt;% 
  get_ci()</code></pre>
<pre><code># A tibble: 1 x 2
   `2.5%` `97.5%`
    &lt;dbl&gt;   &lt;dbl&gt;
1 178.026 178.094</code></pre>
<p>The following function plots a histogram and shades the 90% confidence interval.</p>
<pre class="r"><code>mh_means %&gt;% 
  visualize(endpoints = percentile_ci, direction = &quot;between&quot;)</code></pre>
<p>You can see that 95% of the data stored in the stat variable in bootstrap_distribution falls between the two endpoints with 2.5% to the left outside of the shading and 2.5% to the right outside of the shading. The cut-off points that provide our range are shown with the darker lines.</p>
</div>
</div>
<div id="test" class="section level1">
<h1><span class="header-section-number">2</span> Test</h1>
<p>Are OKCupid men taller? Are presidents taller?</p>
</div>
<div id="data" class="section level1">
<h1><span class="header-section-number">3</span> Data</h1>
<p><a href="https://www.cdc.gov/brfss/annual_data/annual_2016.html" class="uri">https://www.cdc.gov/brfss/annual_data/annual_2016.html</a></p>
</div>
<div id="resources" class="section level1">
<h1><span class="header-section-number">4</span> Resources</h1>
<p>tinyurl.com/inference3</p>
<p><a href="https://github.com/AllenDowney/CompStats/blob/master/resampling.ipynb" class="uri">https://github.com/AllenDowney/CompStats/blob/master/resampling.ipynb</a></p>
</div>

<p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="by-nc.png" height="400" width="65"/></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
